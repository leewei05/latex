\documentclass[a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{clrscode4e} % Algorithm template from Introduction to Algorithms 4th
\usepackage[left=2cm,right=2cm,top=1cm,bottom=2cm]{geometry} % page settings
\usepackage{amsthm, amsmath} % provides many mathematical environments & tools
\usepackage{tikz} % draw pictures
\usepackage{tabularray}
\usetikzlibrary{positioning,matrix, arrows.meta}
\tikzset{box/.style={draw, thick, minimum width=1cm, minimum height=1cm}}

\newenvironment{solution}
  {\begin{proof}[Solution]}
  {\end{proof}}
\renewcommand{\qedsymbol}{\rule{0.7em}{0.7em}}

\makeatletter
\renewenvironment{proof}[1][\proofname]{%
  \par\pushQED{\qed}\normalfont%
  \topsep6\p@\@plus6\p@\relax
  \trivlist\item[\hskip\labelsep\bfseries#1\@addpunct{.}]%
  \ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}
\makeatother

\setlength{\parindent}{0mm}

\begin{document}

\title{Algorithms: Homework 1}
\author{Li-Yuan Wei}
\date{\today}
\maketitle

\subsection*{Problem 1}
\begin{codebox}
\Procname{$\proc{Insertion-Sort}(A)$}
\li \For $j \gets 2$ \To $\attrib{A}{length}$
\li \Do
$\id{key} \gets A[j]$
\li \Comment Insert $A[j]$ into the sorted sequence
$A[1 \twodots j-1]$.
\li $i \gets j-1$
\li \While $i > 0$ and $A[i] > \id{key}$
\li \Do
$A[i+1] \gets A[i]$
\li $i \gets i-1$
\End
\li $A[i+1] \gets \id{key}$
\End
\end{codebox}

\begin{solution}
\end{solution}

\subsection*{Problem 2}
\begin{codebox}
\Procname{$\proc{Bubble-Sort}(A)$}
\li \For $i \gets 1$ \To $\attrib{A}{length} - 1$
\li \Do \For $j \gets \attrib{A}{length}$ \Downto $i + 1$
\li \Do \If $A[j] < A[j-1]$
\li \Then exchange $A[j]$ with $A[j-1]$
\End
\End
\End
\end{codebox}

\begin{solution}
\end{solution}

\subsection*{Problem 3}

\begin{solution}
  $\lg\lg n < \lg n < \lg n^2 < \lg^2 n< n < 5^{\lg n} < n \lg n < n! < e^n$

 $\lg n^2 = 2\lg n$ \\
 $5^{\lg n} = n^{\lg 5} \approx n^{2.321}$ \\
 ** $\lg\lg n = 2^{\lg(\lg\lg n)}$ \\
 $\lg^2 n = \lg n \lg n > \lg n$
\end{solution}

\subsection*{Problem 4}

\begin{solution}
  (a) Yes, $5n^2 + 2n = \mathcal{O}(n^2)$. From the definition of Big $\mathcal{O}$, we need to find postive constants $c, n_0$ to satisfy $5n^2 + 2n \le cn^2, \forall n \ge n_0$.
  \begin{align*}
    f(n) &= 5n^2 + 2n \le cn^ 2 = cg(n) && \text{divide both functions by $n^2$}\\
        &= 5 + 2/n \le c \\
  \end{align*}

  From the above function, we have $n_0 = 1, c = 7$ to show that $f(n) = \mathcal{O}(n^2)$.
\end{solution}

\begin{solution}
  (b)
\end{solution}

\subsection*{Problem 5}

\subsection*{Problem 6}

\begin{solution}
  (a) Based on master method, we have $a = 4, b = 2, f(n) = n$, which implies that $n^{\log_{b}a} = n^{\log_{2}4} = n^2 = \Theta(n^2)$. Since $f(n) = n = \mathcal{O}(n^{2-\epsilon})$, for any constant $0 < \epsilon \le 1$, we can solve this recurrence by applying case 1 of master method. The solution is $T(n) = \Theta(n^{\log_{b}a}) = \Theta(n^{\log_{2}4}) = \Theta(n^2)$.
\end{solution}

\begin{solution}
  (b) We have $a = 4, b = 2$, and our $f(n) = n^2 = \Theta(n^{\log_{b}a}) = \Theta(n^{\log_{2}4}) = \Theta(n^2)$. Thus, we can directly apply case 2 of master method to solve this recurrence. The solution is $T(n) = \Theta(n^{\log_{b}a}\lg n) = \Theta(n^2\lg n)$.
\end{solution}

\begin{solution}
  (c) We have $a = 4, b = 2$, and our $f(n) = n^3$. First, we assume that we can solve this recurrence with case 3 because $f(n) = n^3 = \Omega(n^{(\log_{b}a) + \epsilon}) = \Omega(n^{(\log_{2}4) + \epsilon}) = \Omega(n^{2 + \epsilon})$. In addition, we verify that $af(n/b) = 4(n/2)^3 = 1/2(n^3) \le 1/2(n^3) = cf(n)$ for $c = 1/2$ is true. As a result, we can conlude that the solution of this recurrence is $T(n) = \Theta(f(n)) = \Theta(n^3)$.
\end{solution}

\subsection*{Problem 7}

\begin{solution}
  We have $a = 4, b = 2, f(n) = n^2\lg n$ from our recurrence, where we have $n^{\log_{b}a} = n^{\log_{2}4} = n^2$. $f(n) = n^2\lg n= \Omega({n^{2 + \epsilon}})$ for some constant $\epsilon$. In addition, we cannot find any constant $c < 1$ that satisfies $af(n/b) = 4(n/2)^2\lg n/2  = n^2\lg n/2 \le cn^2 \lg n$. To verify our statement,

  \begin{align}
    n^2\lg n/2 &\le cn^2 \lg n && \text{divide both by $n^2$}\nonumber\\
    \lg n/2 &\le c\lg n && \lg(ab) = \lg a + \lg b = \lg(n2^{-1}) = \lg n + \lg2^{-1}\nonumber\\
    \lg n - \lg 2 &\le c\lg n && \text{divide both by $\lg n$}\nonumber\\
    1 - \frac{\lg 2}{\lg n} = 1 - \frac{1}{\lg n}&\le c \label{eq:7-1}
  \end{align}

  From \eqref{eq:7-1}, as $n$ approaches to $\infty$, \eqref{eq:7-1} will become $1 \le c$, which did not satisfy the conditions in case 3. Therefore, we have concluded that we cannot solve this recurrence with master method.
\end{solution}
\setcounter{equation}{0}

\subsection*{Problem 8}
\begin{solution}
  Let $m = \lg n, n = 2^m, n^{\frac{1}{3}} = 2^{\frac{m}{3}}$.
  \begin{align}
          & T(n) = 3T(\sqrt[3]{n}) + \lg n && \text{replace $n$ with $2^m$}\nonumber\\
    \equiv\ & T(2^m) = 3T(2^{\frac{m}{3}}) + m && \text{replace $T(2^m)$ with $S(m)$}\nonumber\\
    \equiv\ & S(m) = 3S(\frac{m}{3}) + m \label{eq:8-1} && \text{apply master method from this recurrence}
  \end{align}

  From \eqref{eq:8-1}, we have $a = 3, b = 3, f(m) = m$. Since $f(m) =m = \Theta(m^{\log_{3}{3}}) = \Theta(m)$, we can apply case 2 of master method. Hence, the solution is $T(m) = \Theta(m\lg m)$. However, we want to solve $T(n)$, not $T(m)$. By applying $m = \lg n$ back to $T(m)$, we can have the solution for our original recurrence $T(n) = \Theta(\lg n \lg \lg n)$.
\end{solution}

\subsection*{Problem 9}

\begin{solution}
  (a) Result of each step of $\proc{BUILD-MAX-HEAP}(A)$: \\
\centerline{
\begin{tblr}{
                column{1-Y}={20pt, c, colsep=3pt, font={\bfseries}},
                column{Z}={l, font={\bfseries}},
                row{2-Z}={20pt, m},
                hline{2,Z}={1-Y}{1.5pt,solid},
                hline{2} ={1}{1-Y}{1.5pt,solid},
                hline{3-7} ={2}{1-Y}{1.5pt,solid},
                hline{3-7} ={2}{1-Y}{1.5pt,solid},
                rulesep=10pt,
                abovesep=4.5pt,
                belowsep=1.5pt,
                vline{1-Y}={2-7}{1.5pt, solid}
                }
            1&2&3&4&5&6&7&8&9&10\\
            6&10&4&1&8&7&5&2&9&3& initial state\\
            6&10&4&1&8&7&5&2&9&3& i = 5\\
            6&10&4&9&8&7&5&2&1&3& i = 4\\
            6&10&7&9&8&4&5&2&1&3& i = 3\\
            6&10&7&9&8&4&5&2&1&3& i = 2\\
            10&9&7&6&8&4&5&2&1&3& i = 1\\
        \end{tblr}
}
\end{solution}

\begin{solution}
  (b) $\proc{HEAPSORT(A)}$ \\
\centerline{
\begin{tblr}{
                column{1-Y}={20pt, c, colsep=3pt, font={\bfseries}},
                column{Z}={l, font={\bfseries}},
                row{2-Z}={20pt, m},
                hline{2,Z}={1-Y}{1.5pt,solid},
                hline{2} ={1}{1-Y}{1.5pt,solid},
                hline{3-12} ={2}{1-Y}{1.5pt,solid},
                hline{3-12} ={2}{1-Y}{1.5pt,solid},
                rulesep=10pt,
                abovesep=4.5pt,
                belowsep=1.5pt,
                cell{3}{10}={c=1}{c,blue!20},
                cell{4}{9-10}={c=1}{c,blue!20},
                cell{5}{8-10}={c=1}{c,blue!20},
                cell{6}{7-10}={c=1}{c,blue!20},
                cell{7}{6-10}={c=1}{c,blue!20},
                cell{8}{5-10}={c=1}{c,blue!20},
                cell{9}{4-10}={c=1}{c,blue!20},
                cell{10}{3-10}={c=1}{c,blue!20},
                cell{11}{2-10}={c=1}{c,blue!20},
                cell{12}{1-10}={c=1}{c,blue!20},
                vline{1-Y}={2-12}{1.5pt, solid}
                }
            1&2&3&4&5&6&7&8&9&10\\
            10&9&7&6&8&4&5&2&1&3& initial state\\
            9&8&7&6&3&4&5&2&1&10& i = 10 \\
            8&6&7&2&3&4&5&1&9&10& i = 9 \\
            7&6&5&2&3&4&1&8&9&10& i = 8 \\
            6&3&5&2&1&4&7&8&9&10& i = 7 \\
            5&3&4&2&1&6&7&8&9&10& i = 6 \\
            4&3&1&2&5&6&7&8&9&10& i = 5 \\
            3&2&1&4&5&6&7&8&9&10& i = 4 \\
            2&1&3&4&5&6&7&8&9&10& i = 3 \\
            1&2&3&4&5&6&7&8&9&10& i = 2 \\
            1&2&3&4&5&6&7&8&9&10& Heapsort complete\\
        \end{tblr}
}
\end{solution}

\subsection*{Problem 10}

\begin{codebox}
\Procname{$\proc{HEAP-DELETE}(A,i)$}
\li \If
\li \End
\End
\end{codebox}
\end{document}


